---
title: "Modified Peptides"
output: mod_pep
---

```{r}

library(tidyverse)
library(ggridges)
source('lib.R')


ev <- read_tsv('dat/ev.adj.Fit2.txt_old')
ev.mod <- read_tsv('dat/ev.adj.Fit2.txt')

## look for PSMs that get severely downgraded by our algorithm
peps <- ev %>%
  filter(PEP < 1e-5) %>%
  filter(PEP.new > 1e-3) %>%
  pull('Sequence')

ev.mod <- ev %>%
  group_by(Sequence) %>%
  summarise(num=length(Sequence), mods=length(unique(Modifications))) %>%
  filter(mods > 1) %>%
  arrange(desc(num))

```

```{r}

## take an example peptide and see how it compares between our two sets
# 1, 3
i <- 11
pep <- ev.mod[i,]$Sequence
exp <- ev[ev$Sequence==pep,]
exp %>%
  ggplot(aes(x=`Retention time`, y=Modifications, fill=Modifications)) +
  geom_density_ridges() +
  labs(title=paste('Retention time', pep), x='Retention Time (mins)')

```